<% var title = itinerary.title + ' - Trip Details' %>

  <h1><%= itinerary.title %></h1>

  <% if (itinerary.coverPhoto) { %>
    <div>
      <img src="<%= itinerary.coverPhoto %>" alt="Trip Cover Photo" style="width:300px;">
    </div>
  <% } %>

  <p><strong>Budget:</strong> $<%= itinerary.budget %></p>
  <p><strong>Duration:</strong> <%= itinerary.duration %> days</p>
  <p><strong>Privacy:</strong> <%= itinerary.privacy %></p>

  <hr>

  <h2>Trip Plan</h2>
  <% itinerary.days.forEach((day, index) => { %>
    <div>
      <h3>Day <%= day.dayNumber %></h3>

      <% if (day.activities.length > 0) { %>
        <ul>
          <% day.activities.forEach((activity, activityIndex) => { %>
            <% if (activity) { %>
              <li>
                <% if (typeof activity === 'string') { %>
                  <strong><%= activity %></strong>
                <% } else { %>
                  <strong>
                    <a href="#" onclick="openModal(<%= day.dayNumber %>, <%= activityIndex %>)">
                      <%= activity.title %>
                    </a>
                  </strong>
                <% } %>
              </li>
            <% } %>
          <% }) %>
        </ul>
      <% } else { %>
        <p>No activities yet.</p>
      <% } %>
    </div>

  <% }) %>

  <a href="/itineraries/<%= itinerary._id %>/edit"> Edit this Itinerary</a>

  <!-- Modal -->
  <div id="activityModal" style="display:none; position:fixed; top:10%; left:50%; transform:translateX(-50%); background:white; padding:20px; border:1px solid #ccc; z-index:1000;">
    <h2 id="modalTitle"></h2>
    <p><strong>Description:</strong> <span id="modalDescription"></span></p>
    <p><strong>Time:</strong> <span id="modalTime"></span></p>
    <p><strong>Location:</strong> <span id="modalLocation"></span></p>
    <button onclick="closeModal()">Close</button>
  </div>

  <script>
    const activities = <%- JSON.stringify(itinerary.days) %>;

    function openModal(dayNum, actIdx) {
      const day = activities.find(d => d.dayNumber === dayNum);
      const activity = day.activities[actIdx];

      document.getElementById('modalTitle').innerText = activity.title;
      document.getElementById('modalDescription').innerText = activity.description || 'N/A';
      document.getElementById('modalTime').innerText = activity.time || 'N/A';
      document.getElementById('modalLocation').innerText = activity.location || 'N/A';

      document.getElementById('activityModal').style.display = 'block';
    }

    function closeModal() {
      document.getElementById('activityModal').style.display = 'none';
    }
  </script>
